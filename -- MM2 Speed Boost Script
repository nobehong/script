-- MM2 Speed + Role ESP Script
-- Optimized, smooth, and ready-to-use

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local humanoid = char:WaitForChild("Humanoid")

-- ===== SPEED BOOST =====
local boostedSpeed = 40
humanoid.WalkSpeed = boostedSpeed
print("Speed boosted to:", boostedSpeed)

-- ===== ROLE ESP CONFIG =====
local roleColors = {
    ["Murderer"] = Color3.fromRGB(255,0,0),
    ["Sheriff"] = Color3.fromRGB(0,0,255)
}

local highlights = {} -- stores created Highlight instances

-- Detect role based on tools
local function getRole(player)
    if player.Character then
        local backpack = player:FindFirstChild("Backpack")
        if backpack then
            if backpack:FindFirstChild("Knife") or player.Character:FindFirstChild("Knife") then
                return "Murderer"
            elseif backpack:FindFirstChild("Gun") or player.Character:FindFirstChild("Gun") then
                return "Sheriff"
            end
        end
    end
    return nil
end

-- Create ESP only once per character
local function createESP(character, color)
    if character:FindFirstChild("HumanoidRootPart") and not highlights[character] then
        local highlight = Instance.new("Highlight")
        highlight.Adornee = character
        highlight.FillColor = color
        highlight.OutlineColor = Color3.fromRGB(0,0,0)
        highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
        highlight.Parent = workspace
        highlights[character] = highlight
    end
end

-- Update ESP every frame
RunService.RenderStepped:Connect(function()
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            local role = getRole(player)
            if role and roleColors[role] then
                createESP(player.Character, roleColors[role])
                -- Update color dynamically if role changes
                if highlights[player.Character] then
                    highlights[player.Character].FillColor = roleColors[role]
                end
            end
        end
    end
end)

-- ===== NOTIFICATION =====
game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "speedboost coded by nobehong",
    Text = "Speed Boost + Optimized Role ESP Active!",
    Duration = 5
})
